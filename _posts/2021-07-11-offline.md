---
layout: post
title:  "Using Matplotlib Color Map Offline"
date:   2021-07-11 06:24:13
categories: py5-examples update
---

### Saving a colormap for offline use

```python
#!/usr/bin/env python3

import numpy as np
from matplotlib import cm

# Get 256 entries from "viridis" or any other Matplotlib colormap
colmap = cm.get_cmap('plasma', 256)

# Make a Numpy array of the 256 RGB values
# Each line corresponds to an RGB colour for a greyscale level
np.savetxt('/home/tux/map_color/cmap.csv', (colmap.colors[...,0:3]*255).astype(np.uint8), fmt='%d', delimiter=',')
```

### Using generated colormap in py5 sketch_title

```python
import py5
import numpy as np
import numpy.polynomial.polynomial as polynomial

def settings():
    py5.size(1000, 1000)

def setup():
    global f, fp
    f = polynomial.Polynomial([0,-1,0,0,0,0,0,1], domain=[-2,2]) # -x + x^7
    fp = polynomial.Polynomial.deriv(f)
    x = np.linspace(-5,5,py5.width)
    y = np.linspace(-5,5,py5.height)
    xx, yy = np.meshgrid(x, y)
    pic = np.reshape(newton(0,np.ravel(xx+yy*1j)),[py5.width,py5.height])
    # Load RGB LUT from CSV file
    lut = np.loadtxt('/home/tux/map_color/cmap.csv', dtype=np.uint8, delimiter=',')
    # Make output image, same height and width as grey image, but 3-channel RGB
    result = np.zeros((*pic.shape,3), dtype=np.uint8)
    # Take entries from RGB LUT according to greyscale values in image
    np.take(lut, pic, axis=0, out=result)
    py5.set_np_pixels(result, bands='RGB')

def newton(i, guess):
    a = np.empty(guess.shape,dtype=int)
    a[:] = i
    j = np.abs(f(guess))>.0001
    if np.any(j):
        a[j] = newton(i+1, guess[j] - np.divide(f(guess[j]),fp(guess[j])))
    return a

py5.run_sketch()

```
